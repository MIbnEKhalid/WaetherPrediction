<div class="card weather-card mb-4">
    <div class="card-header bg-primary text-white">
        <div class="d-flex justify-content-between align-items-center">
            <h2 class="mb-0">Weather Data for {{metadata.location}}</h2>
            <div class="btn-group" role="group">
                <a href="/weather?start_date={{startDate}}&end_date={{endDate}}&view=daily"
                    class="btn btn-sm {{#eq currentView 'daily'}}btn-light{{else}}btn-outline-light{{/eq}}">Daily</a>
                <a href="/weather?start_date={{startDate}}&end_date={{endDate}}&view=weekly"
                    class="btn btn-sm {{#eq currentView 'weekly'}}btn-light{{else}}btn-outline-light{{/eq}}">Weekly</a>
                <a href="/weather?start_date={{startDate}}&end_date={{endDate}}&view=monthly"
                    class="btn btn-sm {{#eq currentView 'monthly'}}btn-light{{else}}btn-outline-light{{/eq}}">Monthly</a>
                <a href="/weather?start_date={{startDate}}&end_date={{endDate}}&view=yearly"
                    class="btn btn-sm {{#eq currentView 'yearly'}}btn-light{{else}}btn-outline-light{{/eq}}">Yearly</a>
            </div>
        </div>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p><strong>Date Range:</strong> {{metadata.dateRange.start}} to {{metadata.dateRange.end}}</p>
                <p><strong>Coordinates:</strong> {{metadata.coordinates.latitude}}째N,
                    {{metadata.coordinates.longitude}}째E</p>
            </div>
            <div class="col-md-6">
                <p><strong>Elevation:</strong> {{metadata.elevation}} meters</p>
                <p><strong>Timezone:</strong> {{metadata.timezone}}</p>
            </div>
        </div>

        <div class="alert alert-info mt-3">
            <strong>Viewing:</strong> {{currentView}} data ({{weatherData.length}} records)
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="chart-container card">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">Temperature Trends</h5>
            </div>
            <div class="card-body">
                <canvas id="temperatureChart"></canvas>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="chart-container card">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">Precipitation</h5>
            </div>
            <div class="card-body">
                <canvas id="precipitationChart"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="chart-container card">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">Humidity</h5>
            </div>
            <div class="card-body">
                <canvas id="humidityChart"></canvas>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="chart-container card">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">Wind Speed</h5>
            </div>
            <div class="card-body">
                <canvas id="windSpeedChart"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="card mt-4">
    <div class="card-header bg-primary text-white">
        <h5 class="mb-0">Raw Data ({{currentView}})</h5>
        <a href="/weather/download?start_date={{startDate}}&end_date={{endDate}}&view={{currentView}}"
            class="btn btn-sm btn-success">
            <i class="fas fa-download"></i> Download CSV
        </a>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Period</th>
                        <th>Max Temp (째C)</th>
                        <th>Min Temp (째C)</th>
                        <th>Humidity (%)</th>
                        <th>Precip (mm)</th>
                        <th>Wind (km/h)</th>
                    </tr>
                </thead>
                <tbody>
                    {{#each weatherData}}
                    <tr>
                        <td>{{label}}</td>
                        <td>{{formatNumber temperature_max 1}}</td>
                        <td>{{formatNumber temperature_min 1}}</td>
                        <td>{{formatNumber humidity 1}}</td>
                        <td>{{formatNumber precipitation 1}}</td>
                        <td>{{formatNumber wind_speed 1}}</td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    window.chartData = {{{ json chartData }}};
</script>